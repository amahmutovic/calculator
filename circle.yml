machine:
  php:
    version: 5.3.3
dependencies:
  cache_directories:
      - robotframework==2.8.7
      - robotframework-selenium2library
  pre:
      - ifp=[[! -e robotframework==2.8.7 && robotframework-selenium2library]];then wget https://bootstrap.pypa.io/get-pip.py && sudo python get-pip.py && sudo pip install robotframework==2.8.7 && sudo pip install robotframework-selenium2library; fi
  override:
      - mkdir -p build/logs
      - composer install --dev --no-interaction
      - composer update
      - pecl install xdebug
      - ls -la ~/.phpenv/versions/$(phpenv version-name)
      - echo "extension=xdebug.so" >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/xdebug.ini
  post:
      - wget https://pypi.python.org/packages/source/r/robotframework/robotframework-2.8.7.tar.gz
      - tar -zxvf robotframework-2.8.7.tar.gz
test:
  pre:
    - mkdir unit_test_reports
  override:
    - phpunit --log-junit unit_test_reports/sonar-report.xml --coverage-clover unit_test_reports/sonar-report-coverage.xml UnitTest
  post:
    - cp -R unit_test_reports/* $CIRCLE_ARTIFACTS
    - pybot testArmin.robot
deployment:
  production:
    branch: master
    commands:
      - echo Go to